C51 COMPILER V9.57.0.0   MAIN                                                              12/19/2022 21:07:39 PAGE 1   


C51 COMPILER V9.57.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\MCU\Keil5\C51\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listing
                    -s\main.lst) OBJECT(.\Objects\main.obj)

line level    source

   1          #include <REGX52.H>
   2          #include "LCD1602.h"
   3          #include "DS1302.h"
   4          #include "Delay.h"
   5          #include "key.h"
   6          #include "Timer0.h"
   7          
   8          unsigned char KeyNum, MODE, TimeSetSelect;
   9          //按下按键1，改变MODE
  10          void TimeShow(void)
  11          {
  12   1              DS1302_ReadTime();
  13   1              LCD_ShowNum(1, 1, DS1302_Time[0], 2);
  14   1              LCD_ShowNum(1, 4, DS1302_Time[1], 2);
  15   1              LCD_ShowNum(1, 7, DS1302_Time[2], 2);
  16   1              LCD_ShowNum(2, 1, DS1302_Time[3], 2);
  17   1              LCD_ShowNum(2, 4, DS1302_Time[4], 2);
  18   1              LCD_ShowNum(2, 7, DS1302_Time[5], 2);   
  19   1      }
  20          
  21          //按键2，设置年月日时分秒
  22          void TimeSet(void)
  23          {
  24   1              if(KeyNum == 2) //切换 年/月/日/时/分/秒 6种单独的模式
  25   1              {
  26   2                      TimeSetSelect++;
  27   2                      if(TimeSetSelect > 5)   TimeSetSelect = 0; //循环切换
  28   2                      //(TimeSetSelect++) %= 6;       //另一种切换方式，越界清零
  29   2                      
  30   2              }
  31   1              LCD_ShowNum(2, 10, TimeSetSelect, 2);   //TEST: 测试切换的按键
  32   1      }
  33          
  34          void main(void)
  35          {
  36   1              LCD_Init();
  37   1              DS1302_Init();
  38   1              LCD_ShowString(1, 1, "  -  -  ");
  39   1              LCD_ShowString(2, 1, "  :  :  ");
  40   1              
  41   1              DS1302_SetTime();
  42   1              
  43   1              while(1)
  44   1              {
  45   2                      KeyNum = key();
  46   2                      if(KeyNum == 1) //按键1连按交替改变按键模式
  47   2                      {
  48   3                              if(MODE == 0)   {       MODE = 1;       }
  49   3                              else if(MODE == 1)      {       MODE = 0;       }
  50   3                      }
  51   2                      switch(MODE)    //交替调用两个函数:初始值为0，显示时间，当按下按键时，模式改为
             -1，时间停止，可以设置时间
  52   2                      {
  53   3                              case 0: TimeShow(); break;
C51 COMPILER V9.57.0.0   MAIN                                                              12/19/2022 21:07:39 PAGE 2   

  54   3                              case 1: TimeSet();      break;
  55   3                      }
  56   2              }
  57   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    205    ----
   CONSTANT SIZE    =     18    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      3    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
